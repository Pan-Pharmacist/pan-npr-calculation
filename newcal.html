<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>เครื่องคำนวณทางเภสัชกรรม</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/css/bootstrap.min.css" rel="stylesheet">
  
  <!-- ฟอนต์ภาษาไทย -->
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600&display=swap" rel="stylesheet" />
  
  <style>
    body {
      font-family: 'Prompt', sans-serif;
      background: linear-gradient(135deg, #a1c4fd 0%, #c2e9fb 100%);
      min-height: 100vh;
    }
    .calculator-card {
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      transition: all 0.3s ease;
      border: none;
      border-radius: 15px;
    }
    .calculator-card:hover {
      transform: translateY(-5px);
    }
    .btn-calculate {
      transition: all 0.2s ease;
      border-radius: 10px;
    }
    .btn-calculate:hover {
      transform: translateY(-2px);
    }
    .btn-calculate:active {
      transform: translateY(0);
    }
    .result-box {
      transition: all 0.3s ease;
      border-radius: 10px;
    }
    .tab-button {
      transition: all 0.3s ease;
      border: none;
      background: none;
      border-bottom: 3px solid transparent;
      border-radius: 0;
    }
    .tab-button.active {
      border-bottom-color: #0d6efd;
      color: #0d6efd;
      font-weight: 600;
    }
    .tab-button:hover {
      color: #0d6efd;
      background-color: rgba(13, 110, 253, 0.1);
    }
    .form-control:focus {
      border-color: #0d6efd;
      box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.25);
    }
    .form-select:focus {
      border-color: #0d6efd;
      box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.25);
    }
    .progress {
      height: 8px;
      border-radius: 4px;
    }
    .copyright {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border-top: 1px solid rgba(255, 255, 255, 0.2);
    }
    .nav-tabs {
      border-bottom: none;
      justify-content: center;
      flex-wrap: wrap;
    }
    .nav-tabs .nav-link {
      border: none;
      color: #6c757d;
      font-weight: 500;
      padding: 0.75rem 1.5rem;
      margin-bottom: 0.5rem;
      border-radius: 8px;
      transition: all 0.3s ease;
    }
    .nav-tabs .nav-link:hover {
      border-color: transparent;
      background-color: rgba(13, 110, 253, 0.1);
      color: #0d6efd;
    }
    .nav-tabs .nav-link.active {
      background-color: #0d6efd;
      color: white;
      border-color: #0d6efd;
    }
    @media (max-width: 768px) {
      .nav-tabs .nav-link {
        padding: 0.5rem 1rem;
        font-size: 0.9rem;
      }
    }
  </style>
</head>
<body>
  <div class="container-fluid px-3 py-4">
    <div class="row justify-content-center">
      <div class="col-12">
        <h1 class="text-center text-dark mb-4 fw-bold display-5">
          เครื่องคำนวณทางเภสัชกรรม
        </h1>

        <!-- Tab Navigation -->
        <ul class="nav nav-tabs mb-4" id="calculatorTabs" role="tablist">
          <li class="nav-item" role="presentation">
            <button class="nav-link active" id="bmi-tab-btn" data-bs-toggle="tab" data-bs-target="#bmi-tab" type="button" role="tab">BMI</button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="bsa-tab-btn" data-bs-toggle="tab" data-bs-target="#bsa-tab" type="button" role="tab">BSA</button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="crcl-tab-btn" data-bs-toggle="tab" data-bs-target="#crcl-tab" type="button" role="tab">Creatinine Clearance</button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="ckd-epi-tab-btn" data-bs-toggle="tab" data-bs-target="#ckd-epi-tab" type="button" role="tab">CKD-EPI eGFR</button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="childpugh-tab-btn" data-bs-toggle="tab" data-bs-target="#childpugh-tab" type="button" role="tab">Child-Pugh Score</button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="ckd-tab-btn" data-bs-toggle="tab" data-bs-target="#ckd-tab" type="button" role="tab">CKD Assessment</button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="hasbled-tab-btn" data-bs-toggle="tab" data-bs-target="#hasbled-tab" type="button" role="tab">HAS-BLED</button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="chadsvasc-tab-btn" data-bs-toggle="tab" data-bs-target="#chadsvasc-tab" type="button" role="tab">CHA₂DS₂-VASc</button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="ibw-tab-btn" data-bs-toggle="tab" data-bs-target="#ibw-tab" type="button" role="tab">IBW Calculator</button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="abw-tab-btn" data-bs-toggle="tab" data-bs-target="#abw-tab" type="button" role="tab">ABW Calculator</button>
          </li>
        </ul>

        <div class="tab-content" id="calculatorTabContent">
          <!-- BMI Calculator -->
          <div class="tab-pane fade show active" id="bmi-tab" role="tabpanel">
            <div class="row justify-content-center">
              <div class="col-lg-8 col-xl-6">
                <div class="card calculator-card">
                  <div class="card-body p-4">
                    <h2 class="card-title text-primary mb-4 h3">คำนวณค่าดัชนีมวลกาย (BMI)</h2>
                    <div class="row g-3">
                      <div class="col-md-6">
                        <label class="form-label fw-medium">น้ำหนัก (kg)</label>
                        <input type="number" id="bmi-weight" class="form-control" placeholder="เช่น 70" />
                      </div>
                      <div class="col-md-6">
                        <label class="form-label fw-medium">ส่วนสูง (cm)</label>
                        <input type="number" id="bmi-height" class="form-control" placeholder="เช่น 170" />
                      </div>
                    </div>
                    <button id="calculate-bmi" class="btn btn-primary btn-calculate w-100 mt-4 py-2 fw-medium">คำนวณ BMI</button>
                    <div id="bmi-result" class="result-box mt-4 p-3 bg-light rounded d-none">
                      <p class="fs-5 mb-2">ค่า BMI ของคุณคือ: <span id="bmi-value" class="fw-bold text-primary"></span></p>
                      <p class="mb-2">การแปลผล: <span id="bmi-category" class="fw-medium text-success"></span></p>
                      <div class="progress mt-3">
                        <div id="bmi-indicator" class="progress-bar bg-primary" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- BSA Calculator -->
          <div class="tab-pane fade" id="bsa-tab" role="tabpanel">
            <div class="row justify-content-center">
              <div class="col-lg-8 col-xl-6">
                <div class="card calculator-card">
                  <div class="card-body p-4">
                    <h2 class="card-title text-primary mb-4 h3">คำนวณพื้นที่ผิวร่างกาย (BSA)</h2>
                    <div class="row g-3">
                      <div class="col-md-6">
                        <label class="form-label fw-medium">น้ำหนัก (kg)</label>
                        <input type="number" id="bsa-weight" class="form-control" placeholder="เช่น 70" />
                      </div>
                      <div class="col-md-6">
                        <label class="form-label fw-medium">ส่วนสูง (cm)</label>
                        <input type="number" id="bsa-height" class="form-control" placeholder="เช่น 170" />
                      </div>
                    </div>
                    <button id="calculate-bsa" class="btn btn-primary btn-calculate w-100 mt-4 py-2 fw-medium">คำนวณ BSA</button>
                    <div id="bsa-result" class="result-box mt-4 p-3 bg-light rounded d-none">
                      <p class="fs-5">พื้นที่ผิวร่างกาย (BSA) ของคุณคือ: <span id="bsa-value" class="fw-bold text-primary"></span> m²</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- CrCl Calculator -->
          <div class="tab-pane fade" id="crcl-tab" role="tabpanel">
            <div class="row justify-content-center">
              <div class="col-lg-8 col-xl-6">
                <div class="card calculator-card">
                  <div class="card-body p-4">
                    <h2 class="card-title text-primary mb-4 h3">คำนวณ Creatinine Clearance (CrCl)</h2>
                    <div class="row g-3">
                      <div class="col-md-6">
                        <label class="form-label fw-medium">อายุ (ปี)</label>
                        <input type="number" id="crcl-age" class="form-control" placeholder="เช่น 65" />
                      </div>
                      <div class="col-md-6">
                        <label class="form-label fw-medium">น้ำหนัก (kg)</label>
                        <input type="number" id="crcl-weight" class="form-control" placeholder="เช่น 70" />
                      </div>
                      <div class="col-md-6">
                        <label class="form-label fw-medium">Serum Creatinine (mg/dL)</label>
                        <input type="number" id="crcl-creatinine" class="form-control" placeholder="เช่น 1.2" step="0.1" />
                      </div>
                      <div class="col-md-6">
                        <label class="form-label fw-medium">เพศ</label>
                        <select id="crcl-sex" class="form-select">
                          <option value="male">ชาย</option>
                          <option value="female">หญิง</option>
                        </select>
                      </div>
                    </div>
                    <button id="calculate-crcl" class="btn btn-primary btn-calculate w-100 mt-4 py-2 fw-medium">คำนวณ CrCl</button>
                    <div id="crcl-result" class="result-box mt-4 p-3 bg-light rounded d-none">
                      <p class="fs-5 mb-2">ค่าประมาณ CrCl: <span id="crcl-value" class="fw-bold text-primary"></span> mL/min</p>
                      <p class="mb-0">การแปลผล: <span id="crcl-interpretation" class="fw-medium text-success"></span></p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- CKD-EPI Calculator -->
          <div class="tab-pane fade" id="ckd-epi-tab" role="tabpanel">
            <div class="row justify-content-center">
              <div class="col-lg-8 col-xl-6">
                <div class="card calculator-card">
                  <div class="card-body p-4">
                    <h2 class="card-title text-primary mb-4 h3">คำนวณค่าอัตราการกรองของไต (CKD-EPI eGFR)</h2>
                    <div class="row g-3">
                      <div class="col-12">
                        <label class="form-label fw-medium">เพศ</label>
                        <div class="d-flex gap-4">
                          <div class="form-check">
                            <input class="form-check-input" type="radio" name="sexs" value="female" id="sex-female" checked>
                            <label class="form-check-label" for="sex-female">หญิง</label>
                          </div>
                          <div class="form-check">
                            <input class="form-check-input" type="radio" name="sexs" value="male" id="sex-male">
                            <label class="form-check-label" for="sex-male">ชาย</label>
                          </div>
                        </div>
                      </div>
                      <div class="col-md-6">
                        <label class="form-label fw-medium">อายุ (ปี)</label>
                        <input type="number" id="ckd-ages" class="form-control" placeholder="เช่น 45" />
                      </div>
                      <div class="col-md-6">
                        <label class="form-label fw-medium">ระดับครีเอทินินในเลือด (mg/dL)</label>
                        <input type="number" id="ckd-creatinines" class="form-control" placeholder="เช่น 1.0" step="0.01" />
                        <small class="text-muted">ค่าปกติ: 0.7-1.3 mg/dL</small>
                      </div>
                    </div>
                    <button id="calculate-ckds" class="btn btn-primary btn-calculate w-100 mt-4 py-2 fw-medium">คำนวณ eGFR</button>
                    <div id="ckd-results" class="result-box mt-4 p-3 bg-light rounded d-none">
                      <p class="fs-5 mb-2">ค่า eGFR ของคุณคือ: <span id="ckd-values" class="fw-bold text-primary"></span> mL/min/1.73m²</p>
                      <p class="mb-2">การแปลผล: <span id="ckd-categorys" class="fw-medium text-success"></span></p>
                      <div class="progress mt-3">
                        <div id="ckd-indicators" class="progress-bar bg-primary" role="progressbar" style="width: 0%"></div>
                      </div>
                      <div class="mt-2">
                        <small class="text-muted">
                          <strong>หมายเหตุ:</strong> ผลการคำนวณนี้เป็นเพียงการประเมินเบื้องต้น ควรปรึกษาแพทย์เพื่อการตรวจวินิจฉัยที่ถูกต้อง
                        </small>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Child-Pugh Score -->
          <div class="tab-pane fade" id="childpugh-tab" role="tabpanel">
            <div class="row justify-content-center">
              <div class="col-lg-8 col-xl-6">
                <div class="card calculator-card">
                  <div class="card-body p-4">
                    <h2 class="card-title text-primary mb-4 h3">Child-Pugh Score</h2>
                    <div class="row g-3">
                      <div class="col-md-6">
                        <label class="form-label fw-medium">Bilirubin (mg/dL)</label>
                        <input type="number" id="cp-bilirubin" class="form-control" placeholder="เช่น 1.5" step="0.1" />
                      </div>
                      <div class="col-md-6">
                        <label class="form-label fw-medium">Albumin (g/dL)</label>
                        <input type="number" id="cp-albumin" class="form-control" placeholder="เช่น 3.5" step="0.1" />
                      </div>
                      <div class="col-md-6">
                        <label class="form-label fw-medium">INR</label>
                        <input type="number" id="cp-inr" class="form-control" placeholder="เช่น 1.2" step="0.1" />
                      </div>
                      <div class="col-md-6">
                        <label class="form-label fw-medium">Ascites</label>
                        <select id="cp-ascites" class="form-select">
                          <option value="1">ไม่มี</option>
                          <option value="2">เล็กน้อย (Diuretics responsive)</option>
                          <option value="3">รุนแรง (diuretic refractory)</option>
                        </select>
                      </div>
                      <div class="col-12">
                        <label class="form-label fw-medium">Encephalopathy</label>
                        <select id="cp-encephalopathy" class="form-select">
                          <option value="1">ไม่มี</option>
                          <option value="2">ระดับ I-II</option>
                          <option value="3">ระดับ III-IV</option>
                        </select>
                      </div>
                    </div>
                    <button id="calculate-cp" class="btn btn-primary btn-calculate w-100 mt-4 py-2 fw-medium">คำนวณคะแนน</button>
                    <div id="cp-result" class="result-box mt-4 p-3 bg-light rounded d-none">
                      <p class="fs-5 mb-2">คะแนนรวม: <span id="cp-score" class="fw-bold fs-4 text-primary"></span></p>
                      <p class="mb-2">Class: <span id="cp-class" class="fw-bold text-success"></span></p>
                      <p class="mb-0">อัตรารอดชีวิต: <span id="cp-survival" class="fw-medium text-muted"></span></p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- CKD Assessment -->
          <div class="tab-pane fade" id="ckd-tab" role="tabpanel">
            <div class="row justify-content-center">
              <div class="col-lg-8 col-xl-6">
                <div class="card calculator-card">
                  <div class="card-body p-4">
                    <h2 class="card-title text-primary mb-4 h3">CKD Assessment</h2>
                    <div class="row g-3">
                      <div class="col-md-6">
                        <label class="form-label fw-medium">eGFR (mL/min/1.73m²)</label>
                        <input type="number" id="ckd-egfr" class="form-control" placeholder="เช่น 60" />
                      </div>
                      <div class="col-md-6">
                        <label class="form-label fw-medium">Albuminuria</label>
                        <select id="ckd-albumin" class="form-select">
                          <option value="A1">A1 (น้อย)</option>
                          <option value="A2">A2 (ปานกลาง)</option>
                          <option value="A3">A3 (สูง)</option>
                        </select>
                      </div>
                    </div>
                    <button id="calculate-ckd" class="btn btn-primary btn-calculate w-100 mt-4 py-2 fw-medium">ประเมินความเสี่ยง CKD</button>
                    <div id="ckd-result" class="result-box mt-4 p-3 bg-light rounded d-none">
                      <p class="fs-5 mb-2">GFR Stage: <span id="ckd-stage" class="fw-bold text-primary"></span></p>
                      <p class="mb-0">Risk Level: <span id="ckd-risk" class="fw-medium text-success"></span></p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- HAS-BLED Calculator -->
          <div class="tab-pane fade" id="hasbled-tab" role="tabpanel">
            <div class="row justify-content-center">
              <div class="col-lg-10 col-xl-8">
                <div class="card calculator-card">
                  <div class="card-body p-4">
                    <h2 class="card-title text-primary mb-4 h3">การประเมินความเสี่ยงเลือดออก (HAS-BLED)</h2>
                    <div class="bg-light p-3 rounded">
                      <h3 class="h5 text-muted mb-3">เลือกปัจจัยเสี่ยงที่มี:</h3>
                      <div class="row g-2">
                        <div class="col-lg-6">
                          <div class="form-check p-2 rounded hover-bg-light">
                            <input class="form-check-input" type="checkbox" id="hasbled-hypertension">
                            <label class="form-check-label" for="hasbled-hypertension">ความดันโลหิตสูงที่ควบคุมไม่ได้ (SBP >160 mmHg)</label>
                          </div>
                        </div>
                        <div class="col-lg-6">
                          <div class="form-check p-2 rounded hover-bg-light">
                            <input class="form-check-input" type="checkbox" id="hasbled-renal">
                            <label class="form-check-label" for="hasbled-renal">โรคไต (Creatinine >2.26 mg/dL หรือ dialysis)</label>
                          </div>
                        </div>
                        <div class="col-lg-6">
                          <div class="form-check p-2 rounded hover-bg-light">
                            <input class="form-check-input" type="checkbox" id="hasbled-liver">
                            <label class="form-check-label" for="hasbled-liver">โรคตับ (Bilirubin >2x normal, AST/ALT/AP >3x normal)</label>
                          </div>
                        </div>
                        <div class="col-lg-6">
                          <div class="form-check p-2 rounded hover-bg-light">
                            <input class="form-check-input" type="checkbox" id="hasbled-bleeding">
                            <label class="form-check-label" for="hasbled-bleeding">ประวัติการเกิดเลือดออก (Major bleeding)</label>
                          </div>
                        </div>
                        <div class="col-lg-6">
                          <div class="form-check p-2 rounded hover-bg-light">
                            <input class="form-check-input" type="checkbox" id="hasbled-inr">
                            <label class="form-check-label" for="hasbled-inr">INR ไม่คงที่ (เวลาใน therapeutic range <60%)</label>
                          </div>
                        </div>
                        <div class="col-lg-6">
                          <div class="form-check p-2 rounded hover-bg-light">
                            <input class="form-check-input" type="checkbox" id="hasbled-age">
                            <label class="form-check-label" for="hasbled-age">อายุมากกว่า 65 ปี</label>
                          </div>
                        </div>
                        <div class="col-lg-6">
                          <div class="form-check p-2 rounded hover-bg-light">
                            <input class="form-check-input" type="checkbox" id="hasbled-medications">
                            <label class="form-check-label" for="hasbled-medications">ใช้ยาต้านเกล็ดเลือด หรือ NSAIDs</label>
                          </div>
                        </div>
                        <div class="col-lg-6">
                          <div class="form-check p-2 rounded hover-bg-light">
                            <input class="form-check-input" type="checkbox" id="hasbled-alcohol">
                            <label class="form-check-label" for="hasbled-alcohol">ดื่มแอลกอฮอล์มาก (≥8 drinks/week)</label>
                          </div>
                        </div>
                        <div class="col-12">
                          <div class="form-check p-2 rounded hover-bg-light">
                            <input class="form-check-input" type="checkbox" id="stroke-hishasbled">
                            <label class="form-check-label" for="stroke-hishasbled">เคยมีประวัติการเกิดโรคหลอดเลือดสมอง (Stroke)</label>
                          </div>
                        </div>
                      </div>
                    </div>
                    <button id="calculate-hasbled" class="btn btn-primary btn-calculate w-100 mt-4 py-2 fw-medium">คำนวณ HAS-BLED</button>
                    <div id="hasbled-result" class="result-box mt-4 p-3 bg-light rounded d-none">
                      <p class="fs-5 mb-2">คะแนน HAS-BLED: <span id="hasbled-score" class="fw-bold fs-4 text-primary"></span></p>
                      <p class="mb-2">ความเสี่ยงเลือดออก: <span id="hasbled-risk" class="fw-medium"></span></p>
                      <p class="mb-0 small text-muted" id="hasbled-recommendation"></p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- CHA₂DS₂-VASc Calculator -->
<div class="tab-pane fade" id="chadsvasc-tab" role="tabpanel">
  <div class="row justify-content-center">
    <div class="col-lg-10 col-xl-8">
      <div class="card calculator-card">
        <div class="card-body p-4">
          <h2 class="card-title text-primary mb-4 h3">การประเมินความเสี่ยงหลอดเลือดสมอง (CHA₂DS₂-VASc)</h2>
          <div class="bg-light p-3 rounded">
            <h3 class="h5 text-muted mb-3">เลือกปัจจัยเสี่ยงที่มี:</h3>
            <div class="row g-2">
              <div class="col-lg-6">
                <div class="form-check p-2 rounded hover-bg-light">
                  <input class="form-check-input" type="checkbox" id="chadsvasc-chf">
                  <label class="form-check-label" for="chadsvasc-chf">ภาวะหัวใจล้มเหลว (Congestive Heart Failure) - 1 คะแนน</label>
                </div>
              </div>
              <div class="col-lg-6">
                <div class="form-check p-2 rounded hover-bg-light">
                  <input class="form-check-input" type="checkbox" id="chadsvasc-ht">
                  <label class="form-check-label" for="chadsvasc-ht">โรคความดันโลหิตสูง (Hypertension) - 1 คะแนน</label>
                </div>
              </div>
              <div class="col-lg-6">
                <div class="form-check p-2 rounded hover-bg-light">
                  <input class="form-check-input" type="checkbox" id="chadsvasc-age65to74">
                  <label class="form-check-label" for="chadsvasc-age65to74">อายุ 65-74 ปี - 1 คะแนน</label>
                </div>
              </div>
              <div class="col-lg-6">
                <div class="form-check p-2 rounded hover-bg-light">
                  <input class="form-check-input" type="checkbox" id="chadsvasc-age75">
                  <label class="form-check-label" for="chadsvasc-age75">อายุ ≥75 ปี - 2 คะแนน</label>
                </div>
              </div>
              <div class="col-lg-6">
                <div class="form-check p-2 rounded hover-bg-light">
                  <input class="form-check-input" type="checkbox" id="chadsvasc-dm">
                  <label class="form-check-label" for="chadsvasc-dm">โรคเบาหวาน (Diabetes) - 1 คะแนน</label>
                </div>
              </div>
              <div class="col-lg-6">
                <div class="form-check p-2 rounded hover-bg-light">
                  <input class="form-check-input" type="checkbox" id="chadsvasc-stroke">
                  <label class="form-check-label" for="chadsvasc-stroke">ประวัติ Stroke/TIA/Systemic embolism - 2 คะแนน</label>
                </div>
              </div>
              <div class="col-lg-6">
                <div class="form-check p-2 rounded hover-bg-light">
                  <input class="form-check-input" type="checkbox" id="chadsvasc-vascular">
                  <label class="form-check-label" for="chadsvasc-vascular">โรคหลอดเลือด (Vascular disease) - 1 คะแนน</label>
                </div>
              </div>
              <div class="col-lg-6">
                <div class="form-check p-2 rounded hover-bg-light">
                  <input class="form-check-input" type="checkbox" id="chadsvasc-sex">
                  <label class="form-check-label" for="chadsvasc-sex">เพศหญิง (Sex category) - 1 คะแนน</label>
                </div>
              </div>
            </div>
          </div>
          <button id="calculate-chadsvasc" class="btn btn-primary btn-calculate w-100 mt-4 py-2 fw-medium">คำนวณ CHA₂DS₂-VASc</button>
          <div id="chadsvasc-result" class="result-box mt-4 p-3 bg-light rounded d-none">
            <p class="fs-5 mb-2">คะแนน CHA₂DS₂-VASc: <span id="chadsvasc-score" class="fw-bold fs-4 text-primary"></span></p>
            <p class="mb-2">ความเสี่ยง Stroke: <span id="chadsvasc-risk" class="fw-medium"></span></p>
            <p class="mb-0 small text-muted" id="chadsvasc-recommendation"></p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- IBW Calculator -->
<div class="tab-pane fade" id="ibw-tab" role="tabpanel">
  <div class="row justify-content-center">
    <div class="col-lg-10 col-xl-8">
      <div class="card calculator-card">
        <div class="card-body p-4">
          <h2 class="card-title text-primary mb-4 h3">คำนวณน้ำหนักในอุดมคติ (IBW)</h2>
          <div class="bg-light p-3 rounded">
            <h3 class="h5 text-muted mb-3">กรอกข้อมูลของคุณ:</h3>
            <div class="row g-3">
              <div class="col-md-6">
                <label class="form-label fw-medium">เพศ</label>
                <select id="ibw-sex" class="form-select">
                  <option value="">เลือกเพศ</option>
                  <option value="male">ชาย</option>
                  <option value="female">หญิง</option>
                </select>
              </div>
              <div class="col-md-6">
                <label class="form-label fw-medium">ส่วนสูง (cm)</label>
                <input type="number" id="ibw-height" class="form-control" placeholder="เช่น 170" />
              </div>
            </div>
          </div>
          <button id="calculate-ibw" class="btn btn-primary btn-calculate w-100 mt-4 py-2 fw-medium">คำนวณ IBW</button>
          <div id="ibw-result" class="result-box mt-4 p-3 bg-light rounded d-none">
            <p class="fs-5 mb-2">น้ำหนักในอุดมคติ: <span id="ibw-value" class="fw-bold fs-4 text-primary"></span></p>
            <p class="mb-2">สูตรที่ใช้: <span id="ibw-formula" class="fw-medium"></span></p>
            <div class="mt-3">
              <div class="progress" style="height: 8px;">
                <div id="ibw-indicator" class="progress-bar bg-primary" role="progressbar" style="width: 0%"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ABW Calculator -->
<div class="tab-pane fade" id="abw-tab" role="tabpanel">
  <div class="row justify-content-center">
    <div class="col-lg-10 col-xl-8">
      <div class="card calculator-card">
        <div class="card-body p-4">
          <h2 class="card-title text-primary mb-4 h3">คำนวณน้ำหนักที่ปรับแล้ว (ABW)</h2>
          <div class="bg-light p-3 rounded">
            <h3 class="h5 text-muted mb-3">กรอกข้อมูลของคุณ:</h3>
            <div class="row g-3">
              <div class="col-md-4">
                <label class="form-label fw-medium">เพศ</label>
                <select id="abw-sex" class="form-select">
                  <option value="">เลือกเพศ</option>
                  <option value="male">ชาย</option>
                  <option value="female">หญิง</option>
                </select>
              </div>
              <div class="col-md-4">
                <label class="form-label fw-medium">ส่วนสูง (cm)</label>
                <input type="number" id="abw-height" class="form-control" placeholder="เช่น 170" />
              </div>
              <div class="col-md-4">
                <label class="form-label fw-medium">น้ำหนักจริง (kg)</label>
                <input type="number" id="abw-weight" class="form-control" placeholder="เช่น 80" />
              </div>
            </div>
          </div>
          <button id="calculate-abw" class="btn btn-primary btn-calculate w-100 mt-4 py-2 fw-medium">คำนวณ ABW</button>
          <div id="abw-result" class="result-box mt-4 p-3 bg-light rounded d-none">
            <p class="fs-5 mb-2">IBW: <span id="abw-ibw-value" class="fw-bold fs-4 text-success"></span></p>
            <p class="fs-5 mb-2">ABW: <span id="abw-value" class="fw-bold fs-4 text-primary"></span></p>
            <p class="mb-2">สูตรที่ใช้: <span id="abw-formula" class="fw-medium"></span></p>
            <div class="mt-3">
              <div class="progress" style="height: 8px;">
                <div id="abw-indicator" class="progress-bar bg-primary" role="progressbar" style="width: 0%"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
        <!-- Bootstrap JS -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/js/bootstrap.bundle.min.js"></script>

        <script>
// Function to show error messages (if you have one)
function showError(message) {
  // Implement your error display logic here, e.g., using an alert or a dedicated div
  alert(message);
}

// ========== BMI Calculator ==========
document.getElementById('calculate-bmi')?.addEventListener('click', () => {
  const weight = parseFloat(document.getElementById('bmi-weight').value);
  const height = parseFloat(document.getElementById('bmi-height').value) / 100;

  if (isNaN(weight) || isNaN(height) || weight <= 0 || height <= 0) {
    showError('กรุณากรอกน้ำหนักและส่วนสูงให้ถูกต้อง');
    return;
  }

  const bmi = weight / (height * height);
  const bmiValue = bmi.toFixed(2);
  let category = '',
    indicatorWidth = 0;

  if (bmi < 18.5) {
    category = 'น้ำหนักน้อย / ผอม';
    indicatorWidth = (bmi / 18.5) * 25;
  } else if (bmi < 23) {
    category = 'ปกติ / สุขภาพดี';
    indicatorWidth = 25 + ((bmi - 18.5) / 4.5) * 25;
  } else if (bmi < 25) {
    category = 'ท้วม / น้ำหนักเกิน';
    indicatorWidth = 50 + ((bmi - 23) / 2) * 25;
  } else if (bmi < 30) {
    category = 'อ้วน';
    indicatorWidth = 75 + ((bmi - 25) / 5) * 25;
  } else {
    category = 'อ้วนมาก / อันตราย';
    indicatorWidth = 100;
  }

  document.getElementById('bmi-value').textContent = bmiValue;
  document.getElementById('bmi-category').textContent = category;
  document.getElementById('bmi-indicator').style.width = `${Math.min(indicatorWidth, 100)}%`;
  document.getElementById('bmi-result').classList.remove('d-none'); // Changed from 'hidden' to 'd-none'
});

// ========== BSA Calculator ==========
document.getElementById('calculate-bsa')?.addEventListener('click', () => {
  const weight = parseFloat(document.getElementById('bsa-weight').value);
  const height = parseFloat(document.getElementById('bsa-height').value);

  if (isNaN(weight) || isNaN(height) || weight <= 0 || height <= 0) {
    showError('กรุณากรอกน้ำหนักและส่วนสูงให้ถูกต้อง');
    return;
  }

  // คำนวณ BSA (Mosteller Formula)
  const bsa = Math.sqrt((height * weight) / 3600);
  const bsaValue = bsa.toFixed(2);

  document.getElementById('bsa-value').textContent = bsaValue;
  document.getElementById('bsa-result').classList.remove('d-none'); // Changed from 'hidden' to 'd-none'
});

// ========== CrCl Calculator ==========
document.getElementById('calculate-crcl')?.addEventListener('click', () => {
  const age = parseFloat(document.getElementById('crcl-age').value);
  const weight = parseFloat(document.getElementById('crcl-weight').value);
  const creatinine = parseFloat(document.getElementById('crcl-creatinine').value);
  const sex = document.getElementById('crcl-sex').value;

  if (isNaN(age) || isNaN(weight) || isNaN(creatinine) || age <= 0 || weight <= 0 || creatinine <= 0) {
    showError('กรุณากรอกข้อมูล CrCl ให้ถูกต้อง');
    return;
  }

  let crcl = ((140 - age) * weight) / (72 * creatinine);
  if (sex === 'female') crcl *= 0.85;

  let interpretation = '';
  if (crcl >= 90) interpretation = 'การทำงานของไตปกติ';
  else if (crcl >= 60) interpretation = 'ไตทำงานลดลงเล็กน้อย';
  else if (crcl >= 30) interpretation = 'ไตทำงานลดลงปานกลาง';
  else if (crcl >= 15) interpretation = 'ไตทำงานลดลงรุนแรง';
  else interpretation = 'ไตวายระยะสุดท้าย';

  document.getElementById('crcl-value').textContent = crcl.toFixed(2);
  document.getElementById('crcl-interpretation').textContent = interpretation;
  document.getElementById('crcl-result').classList.remove('d-none'); // Changed from 'hidden' to 'd-none'
});

// เพิ่มคำนวณค่า CKD-EPI eGFR สำหรับการคำนวณอัตราการกรองของไต
document.getElementById('calculate-ckds').addEventListener('click', () => {
  const ages = parseFloat(document.getElementById('ckd-ages').value);
  const creatinines = parseFloat(document.getElementById('ckd-creatinines').value);
  const sexs = document.querySelector('input[name="sexs"]:checked').value;

  if (isNaN(ages) || isNaN(creatinines) || ages <= 0 || creatinines <= 0) {
    showError('กรุณากรอกข้อมูล CKD-EPI ให้ถูกต้อง');
    return;
  }

  // ใช้ค่า creatinine ในหน่วย mg/dL โดยตรง
  const scrMgDls = creatinines;

  let As, Bs, egfrs;

  if (sexs === 'female') {
    if (scrMgDls <= 0.7) {
      As = 0.7;
      Bs = -0.241;
    } else {
      As = 0.7;
      Bs = -1.2;
    }
    // สูตร CKD-EPI สำหรับหญิง
    egfrs = 142 * Math.pow((scrMgDls / As), Bs) * Math.pow(0.9938, ages) * 1.012;
  } else {
    if (scrMgDls <= 0.9) {
      As = 0.9;
      Bs = -0.302;
    } else {
      As = 0.9;
      Bs = -1.2;
    }
    // สูตร CKD-EPI สำหรับชาย
    egfrs = 142 * Math.pow((scrMgDls / As), Bs) * Math.pow(0.9938, ages);
  }

  const egfrValues = egfrs.toFixed(1);
  let categorys = '';
  let indicatorWidths = 0;
  let categoryColors = '';

  if (egfrs >= 90) {
    categorys = 'ปกติหรือสูง (G1)';
    indicatorWidths = 100;
    categoryColors = 'text-green-600';
  } else if (egfrs >= 60) {
    categorys = 'ลดลงเล็กน้อย (G2)';
    indicatorWidths = 80;
    categoryColors = 'text-yellow-600';
  } else if (egfrs >= 45) {
    categorys = 'ลดลงปานกลาง-รุนแรง (G3a)';
    indicatorWidths = 60;
    categoryColors = 'text-orange-600';
  } else if (egfrs >= 30) {
    categorys = 'ลดลงปานกลาง-รุนแรง (G3b)';
    indicatorWidths = 40;
    categoryColors = 'text-red-500';
  } else if (egfrs >= 15) {
    categorys = 'ลดลงรุนแรง (G4)';
    indicatorWidths = 20;
    categoryColors = 'text-red-600';
  } else {
    categorys = 'ไตวาย (G5)';
    indicatorWidths = 10;
    categoryColors = 'text-red-700';
  }

  document.getElementById('ckd-values').textContent = egfrValues;
  document.getElementById('ckd-categorys').textContent = categorys;
  document.getElementById('ckd-categorys').className = `font-medium ${categoryColors}`;
  document.getElementById('ckd-indicators').style.width = `${Math.min(indicatorWidths, 100)}%`;
  document.getElementById('ckd-results').classList.remove('d-none'); // Changed from 'hidden' to 'd-none'
});


// ========== Child-Pugh Calculator ==========
document.getElementById('calculate-cp')?.addEventListener('click', () => {
  const bilirubin = parseFloat(document.getElementById('cp-bilirubin').value);
  const albumin = parseFloat(document.getElementById('cp-albumin').value);
  const inr = parseFloat(document.getElementById('cp-inr').value);
  const ascites = parseInt(document.getElementById('cp-ascites').value);
  const encephalopathy = parseInt(document.getElementById('cp-encephalopathy').value);

  if (isNaN(bilirubin) || isNaN(albumin) || isNaN(inr) || bilirubin < 0 || albumin < 0 || inr < 0) {
    showError('กรุณากรอกข้อมูล Child-Pugh ให้ถูกต้อง');
    return;
  }

  // Calculate points for each parameter
  let bilirubinScore = 1;
  if (bilirubin > 2 && bilirubin <= 3) bilirubinScore = 2;
  else if (bilirubin > 3) bilirubinScore = 3;

  let albuminScore = 1;
  if (albumin >= 2.8 && albumin < 3.5) albuminScore = 2;
  else if (albumin < 2.8) albuminScore = 3;

  let inrScore = 1;
  if (inr > 1.7 && inr <= 2.3) inrScore = 2;
  else if (inr > 2.3) inrScore = 3;

  const totalScore = bilirubinScore + albuminScore + inrScore + ascites + encephalopathy;

  let cpClass = '';
  let survival = '';

  if (totalScore <= 6) {
    cpClass = 'A';
    survival = '15-20 ปี';
  } else if (totalScore <= 9) {
    cpClass = 'B';
    survival = '4-14 ปี';
  } else {
    cpClass = 'C';
    survival = '1-3 ปี';
  }

  document.getElementById('cp-score').textContent = totalScore;
  document.getElementById('cp-class').textContent = cpClass;
  document.getElementById('cp-survival').textContent = survival;
  document.getElementById('cp-result').classList.remove('d-none'); // Changed from 'hidden' to 'd-none'
});

// ========== CKD ==========
document.getElementById('calculate-ckd').addEventListener('click', () => {
  const egfr = parseFloat(document.getElementById('ckd-egfr').value);
  const albumin = document.getElementById('ckd-albumin').value;

  if (isNaN(egfr) || egfr <= 0) {
    showError('กรุณากรอกค่า eGFR ให้ถูกต้อง');
    return;
  }

  let stage = '';
  if (egfr >= 90) stage = 'G1';
  else if (egfr >= 60) stage = 'G2';
  else if (egfr >= 45) stage = 'G3a';
  else if (egfr >= 30) stage = 'G3b';
  else if (egfr >= 15) stage = 'G4';
  else stage = 'G5';

  let risk = '';
  if ((stage === 'G1' && albumin === 'A1') || (stage === 'G2' && albumin === 'A1')) risk = 'ความเสี่ยงต่ำ';
  else if ((stage === 'G1' && albumin === 'A2') || (stage === 'G2' && albumin === 'A2') || (stage === 'G3a' && albumin === 'A1')) risk = 'ความเสี่ยงปานกลาง';
  else if ((stage === 'G1' && albumin === 'A3') || (stage === 'G2' && albumin === 'A3') || (stage === 'G3a' && albumin === 'A2') || (stage === 'G3b' && albumin === 'A1') || (stage === 'G4' && albumin === 'A1')) risk = 'ความเสี่ยงสูง';
  else risk = 'ความเสี่ยงสูงมาก';

  document.getElementById('ckd-stage').textContent = stage;
  document.getElementById('ckd-risk').textContent = risk;
  document.getElementById('ckd-result').classList.remove('d-none'); // Changed from 'hidden' to 'd-none'
});

// ========== HAS-BLED Calculator ==========
document.getElementById('calculate-hasbled')?.addEventListener('click', () => {
  let score = 0;

  // Count checked risk factors
  if (document.getElementById('hasbled-hypertension').checked) score += 1;
  if (document.getElementById('hasbled-renal').checked) score += 1;
  if (document.getElementById('hasbled-liver').checked) score += 1;
  if (document.getElementById('hasbled-bleeding').checked) score += 1;
  if (document.getElementById('hasbled-inr').checked) score += 1;
  if (document.getElementById('hasbled-age').checked) score += 1;
  if (document.getElementById('hasbled-medications').checked) score += 1;
  if (document.getElementById('hasbled-alcohol').checked) score += 1;
  if (document.getElementById('stroke-hishasbled').checked) score += 1;

  let riskLevel = '';
  let riskColor = '';
  let recommendation = '';

  if (score === 0) {
    riskLevel = 'ความเสี่ยงต่ำ (Low Risk) - Risk of major bleeding 0.9% / 1.13 Bleeds per 100 patient-years';
    riskColor = 'text-green-600';
    recommendation = 'พิจารณาใช้ยาต้านการแข็งตัวของเลือด (Anticoagulation) ได้';
  } else if (score === 1) {
    riskLevel = 'ความเสี่ยงต่ำ (Low Risk) - Risk of major bleeding 3.4% / 1.02 Bleeds per 100 patient-years';
    riskColor = 'text-green-600';
    recommendation = 'พิจารณาใช้ยาต้านการแข็งตัวของเลือด (Anticoagulation) ได้';
  } else if (score === 2) {
    riskLevel = 'ความเสี่ยงปานกลาง (Moderate Risk) - Risk of major bleeding 4.1% / 1.88 Bleeds per 100 patient-years';
    riskColor = 'text-yellow-600';
    recommendation = 'สามารถพิจารณาใช้ยาต้านการแข็งตัวของเลือด (Anticoagulation)';
  } else if (score === 3) {
    riskLevel = 'ความเสี่ยงสูง (High Risk) - Risk of major bleeding 5.8% / 3.72 ต่อ 100 Bleeds per 100 patient-years';
    riskColor = 'text-orange-600';
    recommendation = 'พิจารณาทางเลือกอื่นแทนยาต้านการแข็งตัวของเลือด (Anticoagulation)';
  } else if (score === 4) {
    riskLevel = 'ความเสี่ยงสูง (High Risk) - Risk of major bleeding 8.9% / 8.7 ต่อ 100 Bleeds per 100 patient-years';
    riskColor = 'text-orange-700';
    recommendation = 'พิจารณาทางเลือกอื่นแทนยาต้านการแข็งตัวของเลือด (Anticoagulation)';
  } else if (score === 5) {
    riskLevel = 'ความเสี่ยงสูงมาก (Very High Risk) - Risk of major bleeding 9.1% / 12.5 ต่อ 100 Bleeds per 100 patient-years';
    riskColor = 'text-red-600';
    recommendation = 'ควรหลีกเลี่ยงยาต้านการแข็งตัวของเลือด (Anticoagulation) และแก้ไขปัจจัยเสี่ยง';
  } else if (score > 5) {
    riskLevel = 'ความเสี่ยงสูงมาก (Very High Risk) - ไม่มีข้อมูลเปอร์เซ็นต์';
    riskColor = 'text-red-700';
    recommendation = 'ควรหลีกเลี่ยงยาต้านการแข็งตัวของเลือด (Anticoagulation) และแก้ไขปัจจัยเสี่ยง';
  } else {
    riskLevel = 'ไม่ทราบคะแนนหรือกรอกไม่ถูกต้อง';
    riskColor = 'text-gray-500';
    recommendation = 'กรุณากรอกคะแนน HAS-BLED ให้ถูกต้อง';
  }

  document.getElementById('hasbled-score').textContent = score;
  document.getElementById('hasbled-risk').textContent = riskLevel;
  document.getElementById('hasbled-risk').className = `font-medium ${riskColor}`;
  document.getElementById('hasbled-recommendation').textContent = recommendation;
  document.getElementById('hasbled-result').classList.remove('d-none'); // Changed from 'hidden' to 'd-none'
});

// ========== CHA₂DS₂-VASc Calculator ==========
document.getElementById('calculate-chadsvasc')?.addEventListener('click', () => {
  let score = 0;

  // Count points for each risk factor
  if (document.getElementById('chadsvasc-chf').checked) score += 1;
  if (document.getElementById('chadsvasc-ht').checked) score += 1;
  if (document.getElementById('chadsvasc-age65to74').checked) score += 1;
  if (document.getElementById('chadsvasc-age75').checked) score += 2;
  if (document.getElementById('chadsvasc-dm').checked) score += 1;
  if (document.getElementById('chadsvasc-stroke').checked) score += 2;
  if (document.getElementById('chadsvasc-vascular').checked) score += 1;
  if (document.getElementById('chadsvasc-sex').checked) score += 1;

  let riskLevel = '';
  let riskColor = '';
  let recommendation = '';

  if (score === 0) {
    riskLevel = 'ความเสี่ยงต่ำมาก (Very Low Risk) - 0.5% per 100 Patient Years';
    riskColor = 'text-green-600';
    recommendation = 'ไม่แนะนำให้ใช้ยาต้านการแข็งตัวของเลือด (Anticoagulation)';
  } else if (score === 1) {
    riskLevel = 'ความเสี่ยงต่ำ (Low Risk) - 1.5% ต่อ 100 per 100 Patient Years';
    riskColor = 'text-green-600';
    recommendation = 'อาจพิจารณาใช้ยาต้านการแข็งตัวของเลือด (Anticoagulation)';
  } else if (score === 2) {
    riskLevel = 'ความเสี่ยงปานกลาง (Moderate Risk) - 2.9% per 100 Patient Years';
    riskColor = 'text-yellow-600';
    recommendation = 'แนะนำให้ใช้ยาต้านการแข็งตัวของเลือด (Anticoagulation)';
  } else if (score === 3) {
    riskLevel = 'ความเสี่ยงสูง (High Risk) - 5.1% per 100 Patient Years';
    riskColor = 'text-orange-600';
    recommendation = 'แนะนำให้ใช้ยาต้านการแข็งตัวของเลือด (Anticoagulation)';
  } else if (score === 4) {
    riskLevel = 'ความเสี่ยงสูง (High Risk) - 7.3% per 100 Patient Years';
    riskColor = 'text-orange-600';
    recommendation = 'แนะนำให้ใช้ยาต้านการแข็งตัวของเลือด (Anticoagulation)';
  } else if (score === 5) {
    riskLevel = 'ความเสี่ยงสูง (High Risk) - 11.2% per 100 Patient Years';
    riskColor = 'text-orange-600';
    recommendation = 'แนะนำให้ใช้ยาต้านการแข็งตัวของเลือด (Anticoagulation)';
  } else if (score === 6) {
    riskLevel = 'ความเสี่ยงสูง (High Risk) - 15.5% per 100 Patient Years';
    riskColor = 'text-red-600';
    recommendation = 'แนะนำให้ใช้ยาต้านการแข็งตัวของเลือด (Anticoagulation)';
  } else if (score === 7) {
    riskLevel = 'ความเสี่ยงสูง (High Risk) - 14.7% per 100 Patient Years';
    riskColor = 'text-red-600';
    recommendation = 'แนะนำให้ใช้ยาต้านการแข็งตัวของเลือด (Anticoagulation)';
  } else if (score === 8) {
    riskLevel = 'ความเสี่ยงสูง (High Risk) - 19.5% per 100 Patient Years';
    riskColor = 'text-red-700';
    recommendation = 'แนะนำให้ใช้ยาต้านการแข็งตัวของเลือด (Anticoagulation)';
  } else {
    riskLevel = 'ไม่ทราบคะแนนหรือกรอกไม่ถูกต้อง';
    riskColor = 'text-gray-500';
    recommendation = 'กรุณากรอกคะแนน CHA₂DS₂-VASc ให้ถูกต้อง';
  }

  document.getElementById('chadsvasc-score').textContent = score;
  document.getElementById('chadsvasc-risk').textContent = riskLevel;
  document.getElementById('chadsvasc-risk').className = `font-medium ${riskColor}`;
  document.getElementById('chadsvasc-recommendation').textContent = recommendation;
  document.getElementById('chadsvasc-result').classList.remove('d-none'); // Changed from 'hidden' to 'd-none'
});
// ========== IBW Calculator ==========
document.getElementById('calculate-ibw').addEventListener('click', () => {
  const sex = document.getElementById('ibw-sex').value;
  const height = parseFloat(document.getElementById('ibw-height').value);

  if (!sex || isNaN(height) || height <= 0) {
    showError('กรุณากรอกข้อมูลให้ครบถ้วนและถูกต้อง');
    return;
  }

  // Convert height from cm to inches for calculation
  const heightInches = height / 2.54;

  // Check if height is less than 60 inches
  if (heightInches < 60) {
    document.getElementById('ibw-value').textContent = 'ไม่สามารถคำนวณได้';
    document.getElementById('ibw-formula').textContent = 'หมายเหตุ: สูตรนี้เหมาะสำหรับผู้ที่มีส่วนสูง 60 นิ้ว (5 ฟุต) ขึ้นไป';
    document.getElementById('ibw-indicator').style.width = '0%';
    document.getElementById('ibw-result').classList.remove('d-none'); // Changed from 'hidden' to 'd-none'
    return;
  }

  let ibw, formula;
  if (sex === 'male') {
    ibw = 50 + 2.3 * (heightInches - 60);
    formula = '50 + 2.3 × (' + heightInches.toFixed(1) + ' - 60)';
  } else {
    ibw = 45.5 + 2.3 * (heightInches - 60);
    formula = '45.5 + 2.3 × (' + heightInches.toFixed(1) + ' - 60)';
  }

  const ibwValue = Math.max(ibw, 0).toFixed(1);

  document.getElementById('ibw-value').textContent = ibwValue + ' kg';
  document.getElementById('ibw-formula').textContent = formula + ' = ' + ibwValue + ' kg';
  document.getElementById('ibw-indicator').style.width = Math.min((ibw / 100) * 100, 100) + '%';
  document.getElementById('ibw-result').classList.remove('d-none'); // Changed from 'hidden' to 'd-none'
});

// ========== ABW Calculator ==========
document.getElementById('calculate-abw').addEventListener('click', () => {
  const sex = document.getElementById('abw-sex').value;
  const height = parseFloat(document.getElementById('abw-height').value);
  const actualWeight = parseFloat(document.getElementById('abw-weight').value);

  if (!sex || isNaN(height) || isNaN(actualWeight) || height <= 0 || actualWeight <= 0) {
    showError('กรุณากรอกข้อมูลให้ครบถ้วนและถูกต้อง');
    return;
  }

  // Convert height from cm to inches for calculation
  const heightInches = height / 2.54;

  // Check if height is less than 60 inches
  if (heightInches < 60) {
    document.getElementById('abw-ibw-value').textContent = 'ไม่สามารถคำนวณได้';
    document.getElementById('abw-value').textContent = 'ไม่สามารถคำนวณได้';
    document.getElementById('abw-formula').textContent = 'หมายเหตุ: สูตรนี้เหมาะสำหรับผู้ที่มีส่วนสูง 60 นิ้ว (5 ฟุต) ขึ้นไป';
    document.getElementById('abw-indicator').style.width = '0%';
    document.getElementById('abw-result').classList.remove('d-none'); // Changed from 'hidden' to 'd-none'
    return;
  }

  // Calculate IBW first
  let ibw;
  if (sex === 'male') {
    ibw = 50 + 2.3 * (heightInches - 60);
  } else {
    ibw = 45.5 + 2.3 * (heightInches - 60);
  }

  // Calculate ABW only if actual weight > IBW
  let abw, abwValue;
  if (actualWeight > ibw) {
    abw = ibw + 0.4 * (actualWeight - ibw);
    abwValue = abw.toFixed(1);
  } else {
    abwValue = 'ไม่จำเป็นต้องคำนวณ ABW (น้ำหนักจริง ≤ IBW)';
  }

  const ibwValue = Math.max(ibw, 0).toFixed(1);
  const formula = 'IBW + 0.4 × (' + actualWeight + ' - ' + ibwValue + ')';

  document.getElementById('abw-ibw-value').textContent = ibwValue + ' kg';
  document.getElementById('abw-value').textContent = typeof abwValue === 'string' ? abwValue : abwValue + ' kg';
  document.getElementById('abw-formula').textContent = actualWeight > ibw ? formula + ' = ' + abwValue + ' kg' : 'ใช้ IBW แทน';
  document.getElementById('abw-indicator').style.width = Math.min((ibw / 100) * 100, 100) + '%';
  document.getElementById('abw-result').classList.remove('d-none'); // Changed from 'hidden' to 'd-none'
});
</script>
<footer>
<footer class="copyright text-center py-4 mt-5">
    <div class="container">
      <div class="row">
        <div class="col-12">
          <p class="mb-2 text-gray-700">
            <small>© 2025 Pannawich-NPR. All rights reserved.</small>
          </p>
          <p class="mb-0 text-gray-600">
            <small>เครื่องคำนวณทางเภสัชกรรม | สำหรับการศึกษาและอ้างอิงเท่านั้น</small>
          </p>
        </div>
      </div>
    </div>
  </footer>
</body>
</html>
